<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–∏–¥–∏–∫ ‚Äî AI-–ø—Ä–æ–≤–æ–¥–Ω–∏–∫ –ø–æ –ò–≤–∞–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏</title>
    <style>
        /* ===== CSS –ü–ï–†–ï–ú–ï–ù–ù–´–ï ===== */
        :root {
            --primary-dark: #0F2854;
            --primary-blue: #1C4D8D;
            --primary-light: #4988C4;
            --primary-accent: #BDE8F5;
            --secondary-dark: #0A1D3A;
            --secondary-blue: #153A70;
            --white: #FFFFFF;
            --text-light: #FFFFFF;
            --text-muted: #BDE8F5;
            --text-dark: #0A1D3A;
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;

            --gradient-primary: linear-gradient(135deg, #0F2854 0%, #1C4D8D 100%);
            --gradient-secondary: linear-gradient(135deg, #1C4D8D 0%, #4988C4 100%);
            --gradient-accent: linear-gradient(135deg, #4988C4 0%, #BDE8F5 100%);

            --shadow-sm: 0 2px 4px rgba(15, 40, 84, 0.1);
            --shadow-md: 0 4px 6px rgba(15, 40, 84, 0.15);
            --shadow-lg: 0 10px 15px rgba(15, 40, 84, 0.2);
            --shadow-xl: 0 20px 25px rgba(15, 40, 84, 0.25);

            --border-radius-sm: 8px;
            --border-radius-md: 12px;
            --border-radius-lg: 16px;
            --border-radius-xl: 20px;
            --border-radius-2xl: 24px;

            --transition-fast: 0.15s ease;
            --transition-normal: 0.3s ease;
            --transition-slow: 0.5s ease;
        }

        /* ===== –°–ë–†–û–° –°–¢–ò–õ–ï–ô ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: var(--text-light);
            background: var(--gradient-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        a {
            color: inherit;
            text-decoration: none;
        }

        button {
            font-family: inherit;
            cursor: pointer;
            border: none;
            background: none;
        }

        input, textarea, select {
            font-family: inherit;
            font-size: inherit;
        }

        img {
            max-width: 100%;
            height: auto;
            display: block;
        }

        /* ===== –ê–ù–ò–ú–ê–¶–ò–ò ===== */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        @keyframes shimmer {
            0% {
                background-position: -200% center;
            }
            100% {
                background-position: 200% center;
            }
        }

        @keyframes spin {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }

        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-5px);
            }
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        /* ===== –û–°–ù–û–í–ù–´–ï –°–¢–ò–õ–ò ===== */
        .app-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }

        /* –®–∞–ø–∫–∞ */
        .header {
            background: var(--primary-dark);
            padding: 1.5rem 2rem;
            border-radius: var(--border-radius-xl);
            margin-bottom: 2rem;
            box-shadow: var(--shadow-lg);
            border: 1px solid rgba(189, 232, 245, 0.1);
            position: sticky;
            top: 20px;
            z-index: 100;
            backdrop-filter: blur(10px);
            animation: slideInRight var(--transition-normal);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .logo {
            font-size: 2rem;
            font-weight: 800;
            color: var(--text-light);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            transition: transform var(--transition-normal);
        }

        .logo:hover {
            transform: scale(1.05);
        }

        .logo::before {
            content: 'üó∫Ô∏è';
            font-size: 2.5rem;
            animation: bounce 2s infinite;
        }

        .nav {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .nav-button {
            background: rgba(28, 77, 141, 0.8);
            border: 2px solid var(--primary-accent);
            color: var(--text-light);
            padding: 0.75rem 1.5rem;
            border-radius: var(--border-radius-md);
            font-weight: 600;
            transition: all var(--transition-normal);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            position: relative;
            overflow: hidden;
        }

        .nav-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }

        .nav-button:hover::before {
            left: 100%;
        }

        .nav-button:hover {
            background: var(--primary-blue);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            border-color: var(--text-light);
        }

        .nav-button.active {
            background: var(--gradient-secondary);
            border-color: var(--text-light);
            box-shadow: 0 0 20px rgba(189, 232, 245, 0.3);
            animation: pulse 2s infinite;
        }

        /* –≠–∫—Ä–∞–Ω - –æ–±—â–∏–µ —Å—Ç–∏–ª–∏ */
        .screen {
            display: none;
            animation: fadeIn var(--transition-normal);
        }

        .screen.active {
            display: block;
        }

        /* –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" */
        .back-button {
            background: var(--primary-blue);
            color: var(--text-light);
            border: 2px solid var(--primary-accent);
            padding: 0.75rem 1.5rem;
            border-radius: var(--border-radius-md);
            font-weight: 600;
            margin-bottom: 2rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all var(--transition-normal);
            animation: slideInLeft var(--transition-normal);
        }

        .back-button:hover {
            background: var(--primary-dark);
            transform: translateX(-5px);
            box-shadow: var(--shadow-md);
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ */
        .main-title {
            text-align: center;
            margin-bottom: 2rem;
            color: var(--text-light);
            font-size: 2.5rem;
            position: relative;
            display: inline-block;
            width: 100%;
        }

        .main-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background: var(--primary-accent);
            border-radius: 2px;
        }

        /* ===== –ì–õ–ê–í–ù–´–ô –≠–ö–†–ê–ù ===== */
        .hero-section {
            background: var(--gradient-secondary);
            padding: 4rem 2rem;
            border-radius: var(--border-radius-xl);
            margin-bottom: 3rem;
            text-align: center;
            position: relative;
            overflow: hidden;
            border: 2px solid var(--primary-accent);
            animation: fadeIn 0.8s ease-out;
        }

        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(189, 232, 245, 0.1) 50%, transparent 70%);
            animation: shimmer 3s infinite;
        }

        .hero-title {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: var(--text-light);
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            position: relative;
            animation: float 3s ease-in-out infinite;
        }

        .hero-subtitle {
            font-size: 1.2rem;
            color: var(--text-muted);
            max-width: 800px;
            margin: 0 auto 2rem;
            line-height: 1.6;
        }

        .feature-tags {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 2rem;
        }

        .feature-tag {
            background: rgba(189, 232, 245, 0.2);
            color: var(--text-light);
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-size: 0.9rem;
            border: 1px solid var(--primary-accent);
            transition: all var(--transition-normal);
            animation: fadeIn 0.5s ease-out backwards;
        }

        .feature-tag:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-md);
            background: rgba(189, 232, 245, 0.3);
        }

        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 3rem 0;
        }

        .stat-card {
            background: var(--primary-dark);
            padding: 2rem;
            border-radius: var(--border-radius-xl);
            text-align: center;
            border: 2px solid var(--primary-accent);
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
            animation: fadeIn 0.5s ease-out backwards;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-accent);
        }

        .stat-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: var(--shadow-xl);
            border-color: var(--text-light);
        }

        .stat-number {
            font-size: 3rem;
            font-weight: 800;
            color: var(--primary-accent);
            margin-bottom: 0.5rem;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .stat-label {
            font-size: 1.1rem;
            color: var(--text-muted);
        }

        /* –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç */
        .quick-start {
            text-align: center;
            margin-top: 3rem;
            padding: 3rem;
            background: rgba(10, 29, 58, 0.5);
            border-radius: var(--border-radius-xl);
            border: 2px solid var(--primary-accent);
        }

        .quick-start-title {
            margin-bottom: 1.5rem;
            color: var(--text-light);
            font-size: 2rem;
        }

        .quick-start-description {
            color: var(--text-muted);
            max-width: 600px;
            margin: 0 auto 2rem;
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .quick-start-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* ===== –ö–ù–û–ü–ö–ò ===== */
        .button {
            background: var(--primary-blue);
            color: var(--text-light);
            border: 2px solid var(--primary-accent);
            padding: 0.75rem 1.5rem;
            border-radius: var(--border-radius-md);
            font-weight: 600;
            transition: all var(--transition-normal);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .button:hover::before {
            width: 300px;
            height: 300px;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            border-color: var(--text-light);
        }

        .button-primary {
            background: var(--gradient-secondary);
            border-color: var(--text-light);
        }

        .button-secondary {
            background: rgba(28, 77, 141, 0.5);
            border-color: var(--primary-accent);
        }

        .button-success {
            background: var(--success);
            border-color: var(--success);
        }

        .button-warning {
            background: var(--warning);
            border-color: var(--warning);
        }

        .button-error {
            background: var(--error);
            border-color: var(--error);
        }

        .button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }

        /* ===== –≠–ö–†–ê–ù –ì–û–†–û–î–û–í ===== */
        .cities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .city-card {
            background: var(--primary-dark);
            border-radius: var(--border-radius-xl);
            padding: 2rem;
            border: 2px solid var(--primary-accent);
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
            animation: fadeIn 0.5s ease-out backwards;
        }

        .city-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: var(--shadow-xl);
            border-color: var(--text-light);
        }

        .city-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--gradient-accent);
        }

        .city-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1.5rem;
        }

        .city-name {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--text-light);
            margin-bottom: 0.5rem;
        }

        .city-icon {
            font-size: 2.5rem;
            animation: bounce 2s infinite;
        }

        .city-rating {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin: 0.5rem 0;
            color: var(--primary-accent);
        }

        .rating-stars {
            color: #FFD700;
            font-size: 1.2rem;
        }

        .city-description {
            color: var(--text-muted);
            margin-bottom: 1.5rem;
            line-height: 1.6;
            font-size: 0.95rem;
        }

        .city-images {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.5rem;
            margin: 1rem 0;
        }

        .city-image {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: var(--border-radius-md);
            border: 1px solid var(--primary-accent);
            transition: transform var(--transition-normal);
        }

        .city-image:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-md);
        }

        .city-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .city-actions .button {
            flex: 1;
        }

        /* ===== –ì–ï–ù–ï–†–ê–¢–û–† –ú–ê–†–®–†–£–¢–û–í ===== */
        .generator-container {
            background: var(--primary-dark);
            padding: 2rem;
            border-radius: var(--border-radius-xl);
            border: 2px solid var(--primary-accent);
            margin-top: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-muted);
            font-weight: 600;
            font-size: 1.1rem;
        }

        .form-select,
        .form-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--primary-accent);
            border-radius: var(--border-radius-md);
            background: rgba(10, 29, 58, 0.7);
            color: var(--text-light);
            font-size: 1rem;
            transition: all var(--transition-normal);
        }

        .form-select:focus,
        .form-input:focus {
            outline: none;
            border-color: var(--text-light);
            box-shadow: 0 0 0 3px rgba(189, 232, 245, 0.3);
            transform: translateY(-1px);
        }

        .form-select option {
            background: var(--primary-dark);
            color: var(--text-light);
            padding: 0.5rem;
        }

        .slider-container {
            margin: 1rem 0;
        }

        .slider {
            width: 100%;
            height: 8px;
            -webkit-appearance: none;
            appearance: none;
            background: rgba(10, 29, 58, 0.7);
            border-radius: 4px;
            outline: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--primary-accent);
            cursor: pointer;
            border: 2px solid var(--text-light);
            box-shadow: var(--shadow-md);
        }

        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--primary-accent);
            cursor: pointer;
            border: 2px solid var(--text-light);
            box-shadow: var(--shadow-md);
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 0.5rem;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .slider-value {
            font-weight: bold;
            color: var(--primary-accent);
            font-size: 1.1rem;
        }

        /* –†–µ–∑—É–ª—å—Ç–∞—Ç –º–∞—Ä—à—Ä—É—Ç–∞ */
        .route-result {
            background: var(--primary-blue);
            padding: 2rem;
            border-radius: var(--border-radius-xl);
            margin-top: 2rem;
            border: 2px solid var(--primary-accent);
            display: none;
            animation: fadeIn var(--transition-normal);
        }

        .route-result.show {
            display: block;
        }

        .route-header {
            background: rgba(189, 232, 245, 0.1);
            padding: 1rem;
            border-radius: var(--border-radius-md);
            margin-bottom: 1.5rem;
            border: 1px solid var(--primary-accent);
        }

        .route-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .route-info-item {
            text-align: center;
        }

        .route-info-label {
            display: block;
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
        }

        .route-info-value {
            display: block;
            color: var(--text-light);
            font-weight: 600;
            font-size: 1.1rem;
        }

        .route-points {
            margin: 1.5rem 0;
        }

        .route-point {
            background: rgba(28, 77, 141, 0.3);
            padding: 1rem;
            border-radius: var(--border-radius-md);
            margin-bottom: 0.5rem;
            border-left: 4px solid var(--primary-accent);
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            transition: all var(--transition-normal);
        }

        .route-point:hover {
            background: rgba(28, 77, 141, 0.5);
            transform: translateX(5px);
        }

        .route-point-number {
            background: var(--primary-accent);
            color: var(--primary-dark);
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .route-point-content {
            flex: 1;
        }

        .route-point-title {
            color: var(--text-light);
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .route-point-details {
            color: var(--text-muted);
            font-size: 0.9rem;
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .route-tips {
            background: rgba(189, 232, 245, 0.2);
            padding: 1.5rem;
            border-radius: var(--border-radius-md);
            margin: 1.5rem 0;
            border: 1px solid var(--primary-accent);
        }

        .route-tips-title {
            color: var(--primary-accent);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .route-tips-list {
            list-style: none;
            padding-left: 0;
        }

        .route-tip-item {
            color: var(--text-muted);
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
        }

        .route-tip-item::before {
            content: 'üí°';
            position: absolute;
            left: 0;
        }

        .route-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        /* ===== AI-–ì–ò–î ===== */
        .chat-container {
            background: var(--primary-dark);
            border-radius: var(--border-radius-xl);
            padding: 2rem;
            border: 2px solid var(--primary-accent);
            margin-top: 2rem;
        }

        .chat-messages {
            height: 400px;
            overflow-y: auto;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: rgba(10, 29, 58, 0.5);
            border-radius: var(--border-radius-lg);
            border: 1px solid var(--primary-accent);
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–∫—Ä–æ–ª–ª–±–∞—Ä–∞ */
        .chat-messages::-webkit-scrollbar {
            width: 8px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: rgba(10, 29, 58, 0.3);
            border-radius: 4px;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: var(--primary-accent);
            border-radius: 4px;
        }

        .chat-messages::-webkit-scrollbar-thumb:hover {
            background: var(--primary-light);
        }

        .message {
            padding: 1rem;
            border-radius: var(--border-radius-md);
            max-width: 85%;
            animation: fadeIn var(--transition-fast);
            word-wrap: break-word;
        }

        .user-message {
            background: var(--primary-blue);
            margin-left: auto;
            border-bottom-right-radius: 4px;
            border: 1px solid var(--primary-accent);
            box-shadow: var(--shadow-sm);
        }

        .ai-message {
            background: rgba(28, 77, 141, 0.7);
            margin-right: auto;
            border-bottom-left-radius: 4px;
            border: 1px solid rgba(189, 232, 245, 0.3);
            box-shadow: var(--shadow-sm);
        }

        .typing-indicator {
            padding: 1rem;
            color: var(--text-muted);
            font-style: italic;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(28, 77, 141, 0.3);
            border-radius: var(--border-radius-md);
            margin-right: auto;
            max-width: 150px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--primary-accent);
            border-radius: 50%;
            animation: typingAnimation 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typingAnimation {
            0%, 60%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-8px);
            }
        }

        .chat-input-container {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .chat-input {
            flex: 1;
            padding: 0.75rem 1rem;
            border: 2px solid var(--primary-accent);
            border-radius: var(--border-radius-md);
            background: rgba(10, 29, 58, 0.7);
            color: var(--text-light);
            font-size: 1rem;
            transition: all var(--transition-normal);
            resize: none;
            min-height: 50px;
            max-height: 150px;
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--text-light);
            box-shadow: 0 0 0 3px rgba(189, 232, 245, 0.3);
            transform: translateY(-1px);
        }

        .send-button {
            background: var(--gradient-secondary);
            color: var(--text-light);
            border: 2px solid var(--primary-accent);
            padding: 0.75rem 1.5rem;
            border-radius: var(--border-radius-md);
            font-weight: 600;
            transition: all var(--transition-normal);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            min-width: 120px;
            justify-content: center;
        }

        .send-button:hover:not(:disabled) {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            border-color: var(--text-light);
        }

        /* –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è API */
        .config-section {
            background: var(--primary-dark);
            padding: 2rem;
            border-radius: var(--border-radius-xl);
            border: 2px solid var(--primary-accent);
            margin: 2rem 0;
            position: relative;
            overflow: hidden;
        }

        .config-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-accent);
        }

        .config-info {
            background: rgba(28, 77, 141, 0.3);
            padding: 1rem;
            border-radius: var(--border-radius-md);
            margin: 1rem 0;
            border: 1px solid var(--primary-accent);
        }

        .file-input {
            margin: 1rem 0;
            padding: 1rem;
            border: 2px dashed var(--primary-accent);
            border-radius: var(--border-radius-md);
            background: rgba(10, 29, 58, 0.5);
            color: var(--text-light);
            width: 100%;
            cursor: pointer;
            transition: all var(--transition-normal);
            text-align: center;
        }

        .file-input:hover {
            border-color: var(--text-light);
            background: rgba(28, 77, 141, 0.3);
            transform: translateY(-2px);
        }

        .file-input::file-selector-button {
            background: var(--primary-accent);
            color: var(--primary-dark);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius-sm);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .file-input::file-selector-button:hover {
            background: var(--text-light);
        }

        .status-message {
            padding: 0.75rem;
            border-radius: var(--border-radius-md);
            margin-top: 1rem;
            font-weight: 500;
            text-align: center;
            animation: fadeIn var(--transition-fast);
        }

        .status-success {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .status-warning {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
            border: 1px solid rgba(245, 158, 11, 0.3);
        }

        .status-error {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        /* ===== –ö–ê–†–¢–ê ===== */
        .map-container {
            background: var(--primary-dark);
            border-radius: var(--border-radius-xl);
            padding: 2rem;
            border: 2px solid var(--primary-accent);
            margin-top: 2rem;
            position: relative;
            overflow: hidden;
        }

        .map-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-accent);
        }

        .map-image {
            width: 100%;
            height: 500px;
            object-fit: cover;
            border-radius: var(--border-radius-lg);
            border: 1px solid var(--primary-accent);
            transition: transform var(--transition-normal);
        }

        .map-image:hover {
            transform: scale(1.01);
            box-shadow: var(--shadow-lg);
        }

        .map-overlay {
            position: absolute;
            bottom: 2rem;
            left: 2rem;
            background: rgba(15, 40, 84, 0.9);
            padding: 1rem;
            border-radius: var(--border-radius-md);
            border: 1px solid var(--primary-accent);
            backdrop-filter: blur(10px);
        }

        .map-title {
            color: var(--text-light);
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .city-badges {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .city-badge {
            background: var(--gradient-secondary);
            color: var(--text-light);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            border: 1px solid var(--primary-accent);
        }

        /* ===== –ù–ê–°–¢–†–û–ô–ö–ò ===== */
        .settings-container {
            background: var(--primary-dark);
            padding: 2rem;
            border-radius: var(--border-radius-xl);
            border: 2px solid var(--primary-accent);
            margin-top: 2rem;
        }

        .settings-section {
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid rgba(189, 232, 245, 0.1);
        }

        .settings-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .settings-title {
            color: var(--primary-accent);
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .settings-help {
            background: rgba(189, 232, 245, 0.1);
            padding: 1rem;
            border-radius: var(--border-radius-md);
            margin-top: 1rem;
            border: 1px solid var(--primary-accent);
        }

        .settings-help-title {
            color: var(--primary-accent);
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .settings-help-text {
            color: var(--text-muted);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .code-block {
            background: rgba(10, 29, 58, 0.7);
            padding: 1rem;
            border-radius: var(--border-radius-md);
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: var(--primary-accent);
            margin: 1rem 0;
            border: 1px solid var(--primary-accent);
            overflow-x: auto;
        }

        /* ===== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û ===== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 29, 58, 0.95);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
            animation: fadeIn var(--transition-normal);
        }

        .modal-content {
            background: var(--primary-dark);
            border-radius: var(--border-radius-xl);
            padding: 2rem;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            border: 3px solid var(--primary-accent);
            box-shadow: var(--shadow-xl);
            position: relative;
            animation: slideInRight var(--transition-normal);
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: var(--primary-accent);
            font-size: 2rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-normal);
            z-index: 2;
        }

        .modal-close:hover {
            background: rgba(189, 232, 245, 0.1);
            transform: rotate(90deg);
        }

        /* ===== –ó–ê–ì–õ–£–®–ö–ò –î–õ–Ø –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô ===== */
        .image-placeholder {
            width: 100%;
            height: 120px;
            background: rgba(28, 77, 141, 0.3);
            border-radius: var(--border-radius-md);
            border: 1px solid var(--primary-accent);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        /* ===== –õ–û–ê–î–ï–† ===== */
        .loader {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(189, 232, 245, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary-accent);
            animation: spin 1s linear infinite;
        }

        /* ===== –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ ===== */
        @media (max-width: 1200px) {
            .app-container {
                padding: 15px;
            }

            .hero-title {
                font-size: 2.5rem;
            }
        }

        @media (max-width: 768px) {
            .app-container {
                padding: 10px;
            }

            .header {
                padding: 1rem;
                position: static;
            }

            .header-content {
                flex-direction: column;
                text-align: center;
            }

            .nav {
                justify-content: center;
            }

            .nav-button {
                padding: 0.5rem 1rem;
                font-size: 0.9rem;
            }

            .hero-title {
                font-size: 2rem;
            }

            .hero-subtitle {
                font-size: 1rem;
            }

            .main-title {
                font-size: 2rem;
            }

            .cities-grid {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .chat-messages {
                height: 300px;
            }

            .chat-input-container {
                flex-direction: column;
            }

            .send-button {
                width: 100%;
            }

            .city-images {
                grid-template-columns: 1fr;
            }

            .quick-start-buttons {
                flex-direction: column;
            }

            .city-actions {
                flex-direction: column;
            }

            .route-actions {
                flex-direction: column;
            }

            .route-info-grid {
                grid-template-columns: 1fr;
            }

            .map-overlay {
                position: relative;
                bottom: auto;
                left: auto;
                margin-top: 1rem;
            }

            .modal-content {
                width: 95%;
                padding: 1rem;
            }
        }

        @media (max-width: 480px) {
            .hero-section {
                padding: 2rem 1rem;
            }

            .hero-title {
                font-size: 1.8rem;
            }

            .feature-tags {
                flex-direction: column;
                align-items: center;
            }

            .city-card {
                padding: 1.5rem;
            }

            .generator-container {
                padding: 1.5rem;
            }

            .config-section {
                padding: 1.5rem;
            }
        }

        /* ===== –£–¢–ò–õ–ò–¢–´ ===== */
        .text-center {
            text-align: center;
        }

        .text-muted {
            color: var(--text-muted);
        }

        .text-accent {
            color: var(--primary-accent);
        }

        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mt-3 { margin-top: 1.5rem; }
        .mt-4 { margin-top: 2rem; }
        .mt-5 { margin-top: 3rem; }

        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 1.5rem; }
        .mb-4 { margin-bottom: 2rem; }
        .mb-5 { margin-bottom: 3rem; }

        .p-1 { padding: 0.5rem; }
        .p-2 { padding: 1rem; }
        .p-3 { padding: 1.5rem; }
        .p-4 { padding: 2rem; }
        .p-5 { padding: 3rem; }

        .hidden {
            display: none !important;
        }

        .visible {
            display: block !important;
        }

        .flex {
            display: flex;
        }

        .flex-column {
            flex-direction: column;
        }

        .flex-wrap {
            flex-wrap: wrap;
        }

        .items-center {
            align-items: center;
        }

        .justify-center {
            justify-content: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .gap-1 { gap: 0.5rem; }
        .gap-2 { gap: 1rem; }
        .gap-3 { gap: 1.5rem; }
        .gap-4 { gap: 2rem; }
        .gap-5 { gap: 3rem; }

        .w-full {
            width: 100%;
        }

        .h-full {
            height: 100%;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- –®–ê–ü–ö–ê –° –ù–ê–í–ò–ì–ê–¶–ò–ï–ô -->
        <header class="header">
            <div class="header-content">
                <div class="logo">–ì–∏–¥–∏–∫</div>
                <nav class="nav">
                    <button class="nav-button active" onclick="showScreen('home')">
                        <span>üè†</span> –ì–ª–∞–≤–Ω–∞—è
                    </button>
                    <button class="nav-button" onclick="showScreen('cities')">
                        <span>üèõÔ∏è</span> –ì–æ—Ä–æ–¥–∞
                    </button>
                    <button class="nav-button" onclick="showScreen('generator')">
                        <span>üó∫Ô∏è</span> –ú–∞—Ä—à—Ä—É—Ç—ã
                    </button>
                    <button class="nav-button" onclick="showScreen('ai-guide')">
                        <span>ü§ñ</span> AI-–≥–∏–¥
                    </button>
                    <button class="nav-button" onclick="showScreen('map')">
                        <span>üó∫Ô∏è</span> –ö–∞—Ä—Ç–∞
                    </button>
                    <button class="nav-button" onclick="showScreen('settings')">
                        <span>‚öôÔ∏è</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                    </button>
                </nav>
            </div>
        </header>

        <!-- –ì–õ–ê–í–ù–´–ô –≠–ö–†–ê–ù -->
        <section id="home" class="screen active">
            <div class="hero-section">
                <h1 class="hero-title">–ì–∏–¥–∏–∫ ‚Äî AI-–ø—Ä–æ–≤–æ–¥–Ω–∏–∫ –ø–æ –ò–≤–∞–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏</h1>
                <p class="hero-subtitle">
                    –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç —Å–æ–∑–¥–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –∏ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã –æ –≥–æ—Ä–æ–¥–∞—Ö, –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è—Ö –∏ –∏—Å—Ç–æ—Ä–∏–∏ —Ä–µ–≥–∏–æ–Ω–∞
                </p>
                <div class="feature-tags">
                    <span class="feature-tag">ü§ñ AI-–≥–∏–¥ –æ–Ω–ª–∞–π–Ω</span>
                    <span class="feature-tag">üó∫Ô∏è –£–º–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã</span>
                    <span class="feature-tag">üèõÔ∏è 5 –≥–æ—Ä–æ–¥–æ–≤</span>
                    <span class="feature-tag">‚≠ê –†–µ–π—Ç–∏–Ω–≥–∏ –∏ –æ—Ç–∑—ã–≤—ã</span>
                    <span class="feature-tag">üí¨ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —á–∞—Ç</span>
                    <span class="feature-tag">üì± –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω</span>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">5</div>
                    <div class="stat-label">–ì–æ—Ä–æ–¥–æ–≤ —Å AI-–≥–∏–¥–æ–º</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">50+</div>
                    <div class="stat-label">–î–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">100+</div>
                    <div class="stat-label">–û—Ç–∑—ã–≤–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">4.7‚òÖ</div>
                    <div class="stat-label">–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥</div>
                </div>
            </div>

            <div class="quick-start">
                <h2 class="quick-start-title">üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç</h2>
                <p class="quick-start-description">
                    –ù–∞—á–Ω–∏—Ç–µ —Å –∏–∑—É—á–µ–Ω–∏—è –≥–æ—Ä–æ–¥–æ–≤ –∏–ª–∏ –∑–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å AI-–≥–∏–¥—É –æ –ª—é–±–æ–º –º–µ—Å—Ç–µ –ò–≤–∞–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏.
                    –ù–∞—à –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –ø–æ–º–æ–∂–µ—Ç –≤–∞–º —Å–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∏–¥–µ–∞–ª—å–Ω–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ.
                </p>
                <div class="quick-start-buttons">
                    <button class="button button-primary" onclick="showScreen('cities')">
                        <span>üèõÔ∏è</span> –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –≥–æ—Ä–æ–¥–∞
                    </button>
                    <button class="button" onclick="showScreen('generator')">
                        <span>üó∫Ô∏è</span> –°–æ–∑–¥–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç
                    </button>
                    <button class="button" onclick="showScreen('ai-guide')">
                        <span>ü§ñ</span> –°–ø—Ä–æ—Å–∏—Ç—å AI-–≥–∏–¥–∞
                    </button>
                </div>
            </div>
        </section>

        <!-- –≠–ö–†–ê–ù –ì–û–†–û–î–û–í -->
        <section id="cities" class="screen">
            <button class="back-button" onclick="showScreen('home')">
                <span>‚Üê</span> –ù–∞–∑–∞–¥ –∫ –≥–ª–∞–≤–Ω–æ–π
            </button>

            <h2 class="main-title">üèõÔ∏è –ì–æ—Ä–æ–¥–∞ –ò–≤–∞–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏</h2>

            <div class="cities-grid" id="citiesGrid">
                <!-- –ì–æ—Ä–æ–¥–∞ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
            </div>
        </section>

        <!-- –ì–ï–ù–ï–†–ê–¢–û–† –ú–ê–†–®–†–£–¢–û–í -->
        <section id="generator" class="screen">
            <button class="back-button" onclick="showScreen('home')">
                <span>‚Üê</span> –ù–∞–∑–∞–¥ –∫ –≥–ª–∞–≤–Ω–æ–π
            </button>

            <h2 class="main-title">üó∫Ô∏è –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –º–∞—Ä—à—Ä—É—Ç–æ–≤</h2>

            <div class="generator-container">
                <form id="routeForm">
                    <div class="form-group">
                        <label class="form-label">üèôÔ∏è –í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥</label>
                        <select id="city" class="form-select" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥...</option>
                            <option value="–ò–≤–∞–Ω–æ–≤–æ">–ò–≤–∞–Ω–æ–≤–æ</option>
                            <option value="–®—É—è">–®—É—è</option>
                            <option value="–ö–∏–Ω–µ—à–º–∞">–ö–∏–Ω–µ—à–º–∞</option>
                            <option value="–ü–ª—ë—Å">–ü–ª—ë—Å</option>
                            <option value="–ü–∞–ª–µ—Ö">–ü–∞–ª–µ—Ö</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">üéØ –í–∞—à–∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã</label>
                        <select id="interests" class="form-select" required>
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å—ã...</option>
                            <option value="history">üèõÔ∏è –ò—Å—Ç–æ—Ä–∏—è –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</option>
                            <option value="nature">üå≥ –ü—Ä–∏—Ä–æ–¥–∞ –∏ –ø–∞—Ä–∫–∏</option>
                            <option value="culture">üé≠ –ö—É–ª—å—Ç—É—Ä–∞ –∏ –º—É–∑–µ–∏</option>
                            <option value="religion">‚õ™ –•—Ä–∞–º—ã –∏ –º–æ–Ω–∞—Å—Ç—ã—Ä–∏</option>
                            <option value="gastronomy">üçΩÔ∏è –ï–¥–∞ –∏ –∫–∞—Ñ–µ</option>
                            <option value="all">üåü –í—Å—ë –≤–º–µ—Å—Ç–µ</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">‚è±Ô∏è –í—Ä–µ–º—è –Ω–∞ –æ—Å–º–æ—Ç—Ä (—á–∞—Å—ã)</label>
                        <div class="slider-container">
                            <input type="range" id="time" class="slider" min="1" max="12" value="3"
                                   oninput="updateTimeValue(this.value)">
                            <div class="slider-labels">
                                <span>1 —á–∞—Å</span>
                                <span id="timeValue" class="slider-value">3 —á–∞—Å–∞</span>
                                <span>12 —á–∞—Å–æ–≤</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">üí∞ –ë—é–¥–∂–µ—Ç –Ω–∞ –æ–¥–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞</label>
                        <select id="budget" class="form-select">
                            <option value="free">üéØ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ</option>
                            <option value="low">üí∞ –î–æ 500‚ÇΩ</option>
                            <option value="medium" selected>üíµ 500-2000‚ÇΩ</option>
                            <option value="high">üíé –ë–æ–ª–µ–µ 2000‚ÇΩ</option>
                        </select>
                    </div>

                    <button type="submit" class="button button-primary w-full mt-3">
                        <span>‚ú®</span> –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç
                    </button>
                </form>

                <div id="routeResult" class="route-result">
                    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç –º–∞—Ä—à—Ä—É—Ç–∞ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ JavaScript -->
                </div>
            </div>
        </section>

        <!-- AI-–ì–ò–î -->
        <section id="ai-guide" class="screen">
            <button class="back-button" onclick="showScreen('home')">
                <span>‚Üê</span> –ù–∞–∑–∞–¥ –∫ –≥–ª–∞–≤–Ω–æ–π
            </button>

            <h2 class="main-title">ü§ñ AI-–≥–∏–¥ –ø–æ –ò–≤–∞–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏</h2>

            <div class="config-section" id="apiConfigSection" style="display: none;">
                <h3 class="settings-title">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ API</h3>
                <div id="configInfo"></div>
                <div id="apiStatus" class="mt-2"></div>
            </div>

            <div class="chat-container">
                <div class="chat-messages" id="chatMessages">
                    <div class="message ai-message">
                        <strong>üëã –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –Ø –≤–∞—à AI-–≥–∏–¥ –ø–æ –ò–≤–∞–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏.</strong>
                        <br><br>
                        –Ø –ø–æ–º–æ–≥—É –≤–∞–º —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ –æ –≥–æ—Ä–æ–¥–∞—Ö, –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è—Ö, –º–∞—Ä—à—Ä—É—Ç–∞—Ö –∏ –∏—Å—Ç–æ—Ä–∏–∏ —Ä–µ–≥–∏–æ–Ω–∞.
                        –ó–∞–¥–∞–π—Ç–µ –º–Ω–µ –ª—é–±–æ–π –≤–æ–ø—Ä–æ—Å –æ –ò–≤–∞–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏!
                        <br><br>
                        <strong>üí° –ü—Ä–∏–º–µ—Ä—ã –≤–æ–ø—Ä–æ—Å–æ–≤:</strong>
                        <br>‚Ä¢ "–ö–∞–∫–∏–µ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ –ü–ª—ë—Å–µ –∑–∞ –æ–¥–∏–Ω –¥–µ–Ω—å?"
                        <br>‚Ä¢ "–ö–∞–∫ –¥–æ–±—Ä–∞—Ç—å—Å—è –∏–∑ –ò–≤–∞–Ω–æ–≤–æ –≤ –ü–∞–ª–µ—Ö –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–æ–º?"
                        <br>‚Ä¢ "–ì–¥–µ –ª—É—á—à–µ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –Ω–∞ 2 –¥–Ω—è –≤ –ò–≤–∞–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏ —Å —Å–µ–º—å–µ–π?"
                        <br>‚Ä¢ "–†–∞—Å—Å–∫–∞–∂–∏ –æ–± –∏—Å—Ç–æ—Ä–∏–∏ —Ç–µ–∫—Å—Ç–∏–ª—å–Ω–æ–π –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏ –ò–≤–∞–Ω–æ–≤–æ"
                        <br>‚Ä¢ "–ö–∞–∫–∏–µ –º—É–∑–µ–∏ —Å—Ç–æ–∏—Ç –ø–æ—Å–µ—Ç–∏—Ç—å –≤ –®—É–µ?"
                        <br>‚Ä¢ "–ß—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ –ö–∏–Ω–µ—à–º–µ?"
                    </div>
                </div>

                <div class="chat-input-container">
                    <textarea class="chat-input" id="chatInput"
                              placeholder="–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –æ –ò–≤–∞–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏..."
                              rows="1"
                              onkeydown="handleChatInputKeydown(event)"
                              oninput="autoResizeTextarea(this)"></textarea>
                    <button class="send-button" id="sendButton" onclick="sendMessage()">
                        <span>–û—Ç–ø—Ä–∞–≤–∏—Ç—å</span>
                        <span>‚ÜóÔ∏è</span>
                    </button>
                </div>
            </div>

            <div class="config-section">
                <h3 class="settings-title">üîë –ù–∞—Å—Ç—Ä–æ–π—Ç–µ API –¥–ª—è —Ä–∞–±–æ—Ç—ã AI-–≥–∏–¥–∞</h3>
                <div class="config-info" id="currentConfigInfo">
                    <p>API –∫–ª—é—á –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª settings.txt</p>
                </div>

                <div class="mt-3">
                    <label class="form-label">üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª –Ω–∞—Å—Ç—Ä–æ–µ–∫ (settings.txt)</label>
                    <input type="file" id="settingsFile" class="file-input"
                           accept=".txt" onchange="loadSettingsFile(event)">
                    <p class="text-muted mt-1" style="font-size: 0.9rem;">
                        –§–∞–π–ª –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å API –∫–ª—é—á –≤ —Ñ–æ—Ä–º–∞—Ç–µ: <br>
                        <code>OPENROUTER_API_KEY=–≤–∞—à_–∫–ª—é—á_–∑–¥–µ—Å—å</code>
                    </p>
                </div>

                <div class="settings-help mt-3">
                    <h4 class="settings-help-title">üí° –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å API –∫–ª—é—á?</h4>
                    <p class="settings-help-text">
                        1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å–∞–π—Ç <a href="https://openrouter.ai/" target="_blank" style="color: var(--primary-accent);">OpenRouter.ai</a><br>
                        2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)<br>
                        3. –°–æ–∑–¥–∞–π—Ç–µ API –∫–ª—é—á –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ<br>
                        4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–ª—é—á –≤ —Ñ–∞–π–ª settings.txt
                    </p>
                </div>
            </div>
        </section>

        <!-- –ö–ê–†–¢–ê -->
        <section id="map" class="screen">
            <button class="back-button" onclick="showScreen('home')">
                <span>‚Üê</span> –ù–∞–∑–∞–¥ –∫ –≥–ª–∞–≤–Ω–æ–π
            </button>

            <h2 class="main-title">üó∫Ô∏è –ö–∞—Ä—Ç–∞ –ò–≤–∞–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏</h2>

            <div class="map-container">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8f/Ivanovo_Oblast_map.svg/1200px-Ivanovo_Oblast_map.svg.png"
                     alt="–ö–∞—Ä—Ç–∞ –ò–≤–∞–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏"
                     class="map-image"
                     onerror="this.onerror=null; this.src='data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 1200 800\"><rect width=\"1200\" height=\"800\" fill=\"%231C4D8D\"/><text x=\"600\" y=\"400\" font-family=\"Arial\" font-size=\"48\" fill=\"white\" text-anchor=\"middle\" dominant-baseline=\"middle\">–ö–∞—Ä—Ç–∞ –ò–≤–∞–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏</text></svg>'">

                <div class="map-overlay">
                    <div class="map-title">üìç –û—Å–Ω–æ–≤–Ω—ã–µ –≥–æ—Ä–æ–¥–∞ –æ–±–ª–∞—Å—Ç–∏</div>
                    <div class="city-badges">
                        <span class="city-badge">–ò–≤–∞–Ω–æ–≤–æ</span>
                        <span class="city-badge">–®—É—è</span>
                        <span class="city-badge">–ö–∏–Ω–µ—à–º–∞</span>
                        <span class="city-badge">–ü–ª—ë—Å</span>
                        <span class="city-badge">–ü–∞–ª–µ—Ö</span>
                    </div>
                </div>
            </div>

            <div class="config-section mt-4">
                <h3 class="settings-title">üó∫Ô∏è –û —Ä–µ–≥–∏–æ–Ω–∞—Ö –ò–≤–∞–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏</h3>
                <p class="text-muted">
                    –ò–≤–∞–Ω–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∞ –≤ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π —á–∞—Å—Ç–∏ –†–æ—Å—Å–∏–∏, –≤ –º–µ–∂–¥—É—Ä–µ—á—å–µ –í–æ–ª–≥–∏ –∏ –ö–ª—è–∑—å–º—ã.
                    –†–µ–≥–∏–æ–Ω –±–æ–≥–∞—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ –ø–∞–º—è—Ç–Ω–∏–∫–∞–º–∏, –º—É–∑–µ—è–º–∏, —Ö—Ä–∞–º–∞–º–∏ –∏ –ø—Ä–∏—Ä–æ–¥–Ω—ã–º–∏ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏.
                </p>
            </div>
        </section>

        <!-- –ù–ê–°–¢–†–û–ô–ö–ò -->
        <section id="settings" class="screen">
            <button class="back-button" onclick="showScreen('home')">
                <span>‚Üê</span> –ù–∞–∑–∞–¥ –∫ –≥–ª–∞–≤–Ω–æ–π
            </button>

            <h2 class="main-title">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</h2>

            <div class="settings-container">
                <div class="settings-section">
                    <h3 class="settings-title">üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è AI-–≥–∏–¥–∞</h3>
                    <div id="currentConfig"></div>

                    <div class="mt-3">
                        <label class="form-label">üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ —Ñ–∞–π–ª–∞</label>
                        <input type="file" id="configFile" class="file-input"
                               accept=".txt" onchange="loadSettingsFile(event)">
                        <p class="text-muted mt-1" style="font-size: 0.9rem;">
                            –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ñ–∞–π–ª—ã .txt —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏: OPENROUTER_API_KEY, MODEL, API_URL
                        </p>
                    </div>
                </div>

                <div class="settings-section">
                    <h3 class="settings-title">üîó –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</h3>
                    <div class="flex items-center gap-2 flex-wrap">
                        <button onclick="testApiConnection()" class="button">
                            <span>üß™</span> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API
                        </button>
                        <span id="connectionStatus" class="status-message">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏</span>
                    </div>
                </div>

                <div class="settings-section">
                    <h3 class="settings-title">üîÑ –°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö</h3>
                    <div class="flex gap-2 flex-wrap">
                        <button onclick="clearLocalStorage()" class="button button-warning">
                            <span>üóëÔ∏è</span> –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                        </button>
                        <button onclick="resetApp()" class="button button-error">
                            <span>üîÑ</span> –°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
                        </button>
                    </div>
                    <p class="text-muted mt-1" style="font-size: 0.9rem;">
                        –≠—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –≤–µ—Ä–Ω–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é.
                    </p>
                </div>

                <div class="settings-help">
                    <h4 class="settings-help-title">üí° –°–ø—Ä–∞–≤–∫–∞ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º</h4>
                    <p class="settings-help-text">
                        –î–ª—è —Ä–∞–±–æ—Ç—ã AI-–≥–∏–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º API –∫–ª—é—á –æ—Ç <a href="https://openrouter.ai/" target="_blank" style="color: var(--primary-accent);">OpenRouter.ai</a>.
                        –í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∏–ª–∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –ø–ª–∞—Ç–Ω—ã–µ –¥–ª—è –±–æ–ª–µ–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤.
                    </p>

                    <div class="code-block mt-2">
                        –ü—Ä–∏–º–µ—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ settings.txt:<br>
                        OPENROUTER_API_KEY=sk-or-v1-–≤–∞—à_–∫–ª—é—á_–∑–¥–µ—Å—å<br>
                        MODEL=deepseek/deepseek-chat-v3-0324<br>
                        API_URL=https://openrouter.ai/api/v1/chat/completions
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">√ó</button>
            <div id="modalContent"></div>
        </div>
    </div>

    <!-- JAVASCRIPT -->
    <script>
        // ===== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø =====
        const API_CONFIG = {
            OPENROUTER_API_KEY: '',
            MODEL: 'deepseek/deepseek-chat-v3-0324',
            API_URL: 'https://openrouter.ai/api/v1/chat/completions'
        };

        // ===== –î–ê–ù–ù–´–ï –ì–û–†–û–î–û–í =====
        const CITIES_DATA = {
            "–ò–≤–∞–Ω–æ–≤–æ": {
                icon: "üè≠",
                description: "–°—Ç–æ–ª–∏—Ü–∞ —Ç–µ–∫—Å—Ç–∏–ª—å–Ω–æ–π –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏ –†–æ—Å—Å–∏–∏, –∏–∑–≤–µ—Å—Ç–Ω–∞—è —Å–≤–æ–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–∏–∑–º–∞ –∏ –±–æ–≥–∞—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π. –ù–∞—Å–µ–ª–µ–Ω–∏–µ: ~400,000 —á–µ–ª–æ–≤–µ–∫.",
                images: [
                    "img/–ò–≤–∞–Ω–æ–≤–æ/1.jpg",
                    "img/–ò–≤–∞–Ω–æ–≤–æ/2.jpg",
                    "img/–ò–≤–∞–Ω–æ–≤–æ/3.jpg",
                    "img/–ò–≤–∞–Ω–æ–≤–æ/4.jpg"
                ],
                attractions: [
                    "–©—É–¥—Ä–æ–≤—Å–∫–∞—è –ø–∞–ª–∞—Ç–∫–∞",
                    "–ú—É–∑–µ–π –∏–≤–∞–Ω–æ–≤—Å–∫–æ–≥–æ —Å–∏—Ç—Ü–∞",
                    "–°–≤—è—Ç–æ-–í–≤–µ–¥–µ–Ω—Å–∫–∏–π –∂–µ–Ω—Å–∫–∏–π –º–æ–Ω–∞—Å—Ç—ã—Ä—å",
                    "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –∞–Ω—Å–∞–º–±–ª—å –ø–ª–æ—â–∞–¥–∏ –†–µ–≤–æ–ª—é—Ü–∏–∏",
                    "–î–æ–º-–∫–æ—Ä–∞–±–ª—å",
                    "–ü–∞—Ä–∫ –∏–º. –°—Ç–µ–ø–∞–Ω–æ–≤–∞",
                    "–ò–≤–∞–Ω–æ–≤—Å–∫–∏–π –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π —Ü–∏—Ä–∫",
                    "–ú—É–∑–µ–π –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –∏—Å–∫—É—Å—Å—Ç–≤–∞"
                ],
                rating: 4.2,
                reviews: [
                    { author: "–ê–Ω–Ω–∞", rating: 5, text: "–ü—Ä–µ–∫—Ä–∞—Å–Ω—ã–π –≥–æ—Ä–æ–¥ —Å —É–Ω–∏–∫–∞–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π! –û—Å–æ–±–µ–Ω–Ω–æ –ø–æ–Ω—Ä–∞–≤–∏–ª—Å—è –º—É–∑–µ–π —Å–∏—Ç—Ü–∞." },
                    { author: "–î–º–∏—Ç—Ä–∏–π", rating: 4, text: "–ú–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö –º–µ—Å—Ç, –Ω–æ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã." },
                    { author: "–û–ª—å–≥–∞", rating: 4, text: "–ì–æ—Ä–æ–¥ —Å –±–æ–≥–∞—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ—Å–µ—Ç–∏—Ç–µ –°–≤—è—Ç–æ-–í–≤–µ–¥–µ–Ω—Å–∫–∏–π –º–æ–Ω–∞—Å—Ç—ã—Ä—å." }
                ]
            },
            "–®—É—è": {
                icon: "üïç",
                description: "–û–¥–∏–Ω –∏–∑ –¥—Ä–µ–≤–Ω–µ–π—à–∏—Ö –≥–æ—Ä–æ–¥–æ–≤ –æ–±–ª–∞—Å—Ç–∏, –∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å–≤–æ–µ–π –∫–æ–ª–æ–∫–æ–ª—å–Ω–µ–π –∏ –º—ã–ª–æ–≤–∞—Ä–µ–Ω–Ω–æ–π –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å—é. –ù–∞—Å–µ–ª–µ–Ω–∏–µ: ~55,000 —á–µ–ª–æ–≤–µ–∫.",
                images: [
                    "img/–®—É—è/1.jpg",
                    "img/–®—É—è/2.jpg",
                    "img/–®—É—è/3.jpg",
                    "img/–®—É—è/4.jpg"
                ],
                attractions: [
                    "–ö–æ–ª–æ–∫–æ–ª—å–Ω—è –í–æ—Å–∫—Ä–µ—Å–µ–Ω—Å–∫–æ–≥–æ —Å–æ–±–æ—Ä–∞ (106 –º–µ—Ç—Ä–æ–≤)",
                    "–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω–æ-–∫—Ä–∞–µ–≤–µ–¥—á–µ—Å–∫–∏–π –º—É–∑–µ–π",
                    "–ú—É–∑–µ–π –º—ã–ª–∞",
                    "–ì–æ—Ä–æ–¥—Å–∫–æ–π –ø–∞—Ä–∫ –∫—É–ª—å—Ç—É—Ä—ã –∏ –æ—Ç–¥—ã—Ö–∞",
                    "–¶–µ—Ä–∫–æ–≤—å –ü–µ—Ç—Ä–∞ –∏ –ü–∞–≤–ª–∞",
                    "–®—É–π—Å–∫–∏–π –∏—Å—Ç–æ—Ä–∏–∫–æ-—Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –º—É–∑–µ–π",
                    "–¢–æ—Ä–≥–æ–≤—ã–µ —Ä—è–¥—ã XIX –≤–µ–∫–∞",
                    "–î–æ–º —Ñ–∞–±—Ä–∏–∫–∞–Ω—Ç–∞ –ü–æ—Å—ã–ª–∏–Ω–∞"
                ],
                rating: 4.1,
                reviews: [
                    { author: "–ï–ª–µ–Ω–∞", rating: 5, text: "–û—á–µ–Ω—å –∫–æ–ª–æ—Ä–∏—Ç–Ω—ã–π –≥–æ—Ä–æ–¥! –ú—É–∑–µ–π –º—ã–ª–∞ - —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ!" },
                    { author: "–ê–ª–µ–∫—Å–µ–π", rating: 3, text: "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ, –Ω–æ –º–∞–ª–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∫–∞—Ñ–µ. –ö–æ–ª–æ–∫–æ–ª—å–Ω—è –≤–ø–µ—á–∞—Ç–ª—è–µ—Ç!" },
                    { author: "–ú–∞—Ä–∏–Ω–∞", rating: 4, text: "–£—é—Ç–Ω—ã–π –ø—Ä–æ–≤–∏–Ω—Ü–∏–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥. –í–∏–¥ —Å –∫–æ–ª–æ–∫–æ–ª—å–Ω–∏ –ø–æ—Ç—Ä—è—Å–∞—é—â–∏–π!" }
                ]
            },
            "–ö–∏–Ω–µ—à–º–∞": {
                icon: "‚õµ",
                description: "–í—Ç–æ—Ä–æ–π –ø–æ –≤–µ–ª–∏—á–∏–Ω–µ –≥–æ—Ä–æ–¥ –æ–±–ª–∞—Å—Ç–∏ —Å –±–æ–≥–∞—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π –∏ –∫—Ä–∞—Å–∏–≤–æ–π –≤–æ–ª–∂—Å–∫–æ–π –Ω–∞–±–µ—Ä–µ–∂–Ω–æ–π. –ù–∞—Å–µ–ª–µ–Ω–∏–µ: ~80,000 —á–µ–ª–æ–≤–µ–∫.",
                images: [
                    "img/–ö–∏–Ω–µ—à–º–∞/1.jpg",
                    "img/–ö–∏–Ω–µ—à–º–∞/2.jpg",
                    "img/–ö–∏–Ω–µ—à–º–∞/3.jpg",
                    "img/–ö–∏–Ω–µ—à–º–∞/4.jpg"
                ],
                attractions: [
                    "–í–æ–ª–∂—Å–∫–∏–π –±—É–ª—å–≤–∞—Ä –∏ –±–µ—Å–µ–¥–∫–∞ –û—Å—Ç—Ä–æ–≤—Å–∫–æ–≥–æ",
                    "–ö–∏–Ω–µ—à–µ–º—Å–∫–∏–π –¥—Ä–∞–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ–∞—Ç—Ä",
                    "–ú—É–∑–µ–π –≤–∞–ª–µ–Ω–æ–∫",
                    "–¢—Ä–æ–∏—Ü–∫–æ-–£—Å–ø–µ–Ω—Å–∫–∏–π —Å–æ–±–æ—Ä",
                    "–ö—Ä–∞—Å–Ω—ã–µ –∏ –ë–µ–ª—ã–µ —Ç–æ—Ä–≥–æ–≤—ã–µ —Ä—è–¥—ã",
                    "–ü–∞—Ä–∫ –∫—É–ª—å—Ç—É—Ä—ã –∏ –æ—Ç–¥—ã—Ö–∞ –∏–º. 35-–ª–µ—Ç–∏—è –ü–æ–±–µ–¥—ã",
                    "–ú—É–∑–µ–π –∏—Å—Ç–æ—Ä–∏–∏ –ö–∏–Ω–µ—à–º—ã",
                    "–¶–µ—Ä–∫–æ–≤—å –í–æ–∑–Ω–µ—Å–µ–Ω–∏—è –ì–æ—Å–ø–æ–¥–Ω—è"
                ],
                rating: 4.0,
                reviews: [
                    { author: "–ú–∏—Ö–∞–∏–ª", rating: 4, text: "–£—é—Ç–Ω—ã–π –≥–æ—Ä–æ–¥ —Å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π. –ù–∞–±–µ—Ä–µ–∂–Ω–∞—è - –ø—Ä–æ—Å—Ç–æ —Å–∫–∞–∑–∫–∞!" },
                    { author: "–°–≤–µ—Ç–ª–∞–Ω–∞", rating: 5, text: "–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ—Å–µ—Ç–∏—Ç–µ –º—É–∑–µ–π –≤–∞–ª–µ–Ω–æ–∫ - —ç—Ç–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ!" },
                    { author: "–ò–≥–æ—Ä—å", rating: 4, text: "–•–æ—Ä–æ—à–µ–µ –º–µ—Å—Ç–æ –¥–ª—è —Å–ø–æ–∫–æ–π–Ω–æ–≥–æ –æ—Ç–¥—ã—Ö–∞. –ö—Ä–∞—Å–∏–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞." }
                ]
            },
            "–ü–ª—ë—Å": {
                icon: "üé®",
                description: "–ñ–∏–≤–æ–ø–∏—Å–Ω—ã–π –≥–æ—Ä–æ–¥ –Ω–∞ –í–æ–ª–≥–µ, –≤–¥–æ—Ö–Ω–æ–≤–ª—è–≤—à–∏–π –º–Ω–æ–≥–∏—Ö —Ä—É—Å—Å–∫–∏—Ö —Ö—É–¥–æ–∂–Ω–∏–∫–æ–≤, –≤–∫–ª—é—á–∞—è –õ–µ–≤–∏—Ç–∞–Ω–∞. –ù–∞—Å–µ–ª–µ–Ω–∏–µ: ~2,000 —á–µ–ª–æ–≤–µ–∫.",
                images: [
                    "img/–ü–ª—ë—Å/1.jpg",
                    "img/–ü–ª—ë—Å/2.jpg",
                    "img/–ü–ª—ë—Å/3.jpg",
                    "img/–ü–ª—ë—Å/4.jpg"
                ],
                attractions: [
                    "–í–æ–ª–∂—Å–∫–∞—è –Ω–∞–±–µ—Ä–µ–∂–Ω–∞—è –∏ –°–æ–±–æ—Ä–Ω–∞—è –≥–æ—Ä–∞",
                    "–î–æ–º-–º—É–∑–µ–π –ò—Å–∞–∞–∫–∞ –õ–µ–≤–∏—Ç–∞–Ω–∞",
                    "–ú—É–∑–µ–π –ø–µ–π–∑–∞–∂–∞",
                    "–£—Å–ø–µ–Ω—Å–∫–∏–π —Å–æ–±–æ—Ä XVII –≤–µ–∫–∞",
                    "–°–º–æ—Ç—Ä–æ–≤—ã–µ –ø–ª–æ—â–∞–¥–∫–∏ –Ω–∞ –í–æ–ª–≥—É",
                    "–¶–µ—Ä–∫–æ–≤—å –í–æ—Å–∫—Ä–µ—Å–µ–Ω–∏—è –•—Ä–∏—Å—Ç–æ–≤–∞",
                    "–ú—É–∑–µ–π –¥—Ä–µ–≤–Ω–µ—Ä—É—Å—Å–∫–æ–π —Å–µ–º—å–∏",
                    "–•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≥–∞–ª–µ—Ä–µ–∏ –∏ —Å—É–≤–µ–Ω–∏—Ä–Ω—ã–µ –ª–∞–≤–∫–∏"
                ],
                rating: 4.8,
                reviews: [
                    { author: "–û–ª—å–≥–∞", rating: 5, text: "–ù–µ–≤–µ—Ä–æ—è—Ç–Ω–æ –∫—Ä–∞—Å–∏–≤–æ–µ –º–µ—Å—Ç–æ! –í–æ–∑–¥—É—Ö —á–∏—Å—Ç—ã–π, –≤–∏–¥—ã –∑–∞–≤–æ—Ä–∞–∂–∏–≤–∞—é—â–∏–µ." },
                    { author: "–°–µ—Ä–≥–µ–π", rating: 5, text: "–ò–¥–µ–∞–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ –¥–ª—è –æ—Ç–¥—ã—Ö–∞ –æ—Ç –≥–æ—Ä–æ–¥—Å–∫–æ–π —Å—É–µ—Ç—ã. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤–µ—Ä–Ω—É—Å—å!" },
                    { author: "–¢–∞—Ç—å—è–Ω–∞", rating: 5, text: "–°–∞–º—ã–π –∂–∏–≤–æ–ø–∏—Å–Ω—ã–π –≥–æ—Ä–æ–¥ –Ω–∞ –í–æ–ª–≥–µ! –ú—É–∑–µ–∏ –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã." }
                ]
            },
            "–ü–∞–ª–µ—Ö": {
                icon: "üñåÔ∏è",
                description: "–í—Å–µ–º–∏—Ä–Ω–æ –∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ü–µ–Ω—Ç—Ä –ª–∞–∫–æ–≤–æ–π –º–∏–Ω–∏–∞—Ç—é—Ä—ã –∏ –∏–∫–æ–Ω–æ–ø–∏—Å–∏, –≥–æ—Ä–æ–¥-–º—É–∑–µ–π –ø–æ–¥ –æ—Ç–∫—Ä—ã—Ç—ã–º –Ω–µ–±–æ–º. –ù–∞—Å–µ–ª–µ–Ω–∏–µ: ~5,000 —á–µ–ª–æ–≤–µ–∫.",
                images: [
                    "img/–ü–∞–ª–µ—Ö/1.jpg",
                    "img/–ü–∞–ª–µ—Ö/2.jpg",
                    "img/–ü–∞–ª–µ—Ö/3.jpg",
                    "img/–ü–∞–ª–µ—Ö/4.jpg"
                ],
                attractions: [
                    "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –º—É–∑–µ–π –ø–∞–ª–µ—Ö—Å–∫–æ–≥–æ –∏—Å–∫—É—Å—Å—Ç–≤–∞",
                    "–î–æ–º-–º—É–∑–µ–π –ü.–î. –ö–æ—Ä–∏–Ω–∞",
                    "–ö—Ä–µ—Å—Ç–æ–≤–æ–∑–¥–≤–∏–∂–µ–Ω—Å–∫–∏–π —Ö—Ä–∞–º",
                    "–ú–∞—Å—Ç–µ—Ä—Å–∫–∏–µ –ø–∞–ª–µ—Ö—Å–∫–∏—Ö —Ö—É–¥–æ–∂–Ω–∏–∫–æ–≤",
                    "–°—É–≤–µ–Ω–∏—Ä–Ω—ã–µ –ª–∞–≤–∫–∏ —Å –∞–≤—Ç–æ—Ä—Å–∫–∏–º–∏ —Ä–∞–±–æ—Ç–∞–º–∏",
                    "–ú—É–∑–µ–π –∏–∫–æ–Ω—ã",
                    "–•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —É—á–∏–ª–∏—â–µ",
                    "–ì–∞–ª–µ—Ä–µ—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–∞–ª–µ—Ö—Å–∫–æ–π –º–∏–Ω–∏–∞—Ç—é—Ä—ã"
                ],
                rating: 4.6,
                reviews: [
                    { author: "–¢–∞—Ç—å—è–Ω–∞", rating: 5, text: "–í–æ–ª—à–µ–±–Ω–æ–µ –º–µ—Å—Ç–æ! –ò—Å–∫—É—Å—Å—Ç–≤–æ –ø–∞–ª–µ—Ö—Å–∫–æ–π –º–∏–Ω–∏–∞—Ç—é—Ä—ã –ø–æ—Ä–∞–∂–∞–µ—Ç." },
                    { author: "–í–∏–∫—Ç–æ—Ä", rating: 4, text: "–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –≥–æ—Ä–æ–¥ —Å –±–æ–≥–∞—Ç—ã–º–∏ —Ç—Ä–∞–¥–∏—Ü–∏—è–º–∏. –ú—É–∑–µ–π - —Å–æ–∫—Ä–æ–≤–∏—â–Ω–∏—Ü–∞ —Ä—É—Å—Å–∫–æ–π –∫—É–ª—å—Ç—É—Ä—ã." },
                    { author: "–ï–ª–µ–Ω–∞", rating: 5, text: "–ù–µ–≤–µ—Ä–æ—è—Ç–Ω–∞—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è —Ç–∞–ª–∞–Ω—Ç–∞! –í–∏–∑–∏—Ç –≤ –º–∞—Å—Ç–µ—Ä—Å–∫–∏–µ –æ—Å—Ç–∞–≤–∏–ª –Ω–µ–∑–∞–±—ã–≤–∞–µ–º—ã–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è." }
                ]
            }
        };

        // ===== –ü–ï–†–ï–ú–ï–ù–ù–´–ï =====
        let currentApiKey = '';
        let chatHistory = [];
        let currentCityModal = '';

        // ===== –£–¢–ò–õ–ò–¢–´ =====
        function getHoursEnding(hours) {
            if (hours % 10 === 1 && hours % 100 !== 11) return '—á–∞—Å';
            if (hours % 10 >= 2 && hours % 10 <= 4 && (hours % 100 < 10 || hours % 100 >= 20)) return '—á–∞—Å–∞';
            return '—á–∞—Å–æ–≤';
        }

        function renderStars(rating) {
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            let stars = '';
            for (let i = 0; i < 5; i++) {
                if (i < fullStars) stars += '‚òÖ';
                else if (i === fullStars && hasHalfStar) stars += '‚òÖ';
                else stars += '‚òÜ';
            }
            return stars;
        }

        function autoResizeTextarea(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 150) + 'px';
        }

        // ===== –ù–ê–í–ò–ì–ê–¶–ò–Ø =====
        function showScreen(screenId) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ —ç–∫—Ä–∞–Ω—ã
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });

            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–π —ç–∫—Ä–∞–Ω
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                targetScreen.classList.add('active');
            }

            // –û–±–Ω–æ–≤–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            document.querySelectorAll('.nav-button').forEach(btn => {
                btn.classList.remove('active');
            });

            const activeButton = Array.from(document.querySelectorAll('.nav-button')).find(btn =>
                btn.getAttribute('onclick')?.includes(`'${screenId}'`)
            );

            if (activeButton) {
                activeButton.classList.add('active');
            }

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —ç–∫—Ä–∞–Ω–æ–≤
            switch(screenId) {
                case 'cities':
                    renderCities();
                    break;
                case 'ai-guide':
                    updateApiConfigDisplay();
                    setTimeout(() => document.getElementById('chatInput')?.focus(), 100);
                    break;
                case 'settings':
                    showCurrentConfig();
                    break;
                case 'generator':
                    updateTimeValue(3);
                    break;
            }
        }

        // ===== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ó–ù–ê–ß–ï–ù–ò–Ø –í–†–ï–ú–ï–ù–ò =====
        function updateTimeValue(value) {
            const hours = parseInt(value);
            document.getElementById('timeValue').textContent = `${hours} ${getHoursEnding(hours)}`;
        }

        // ===== –ó–ê–ì–†–£–ó–ö–ê –ù–ê–°–¢–†–û–ï–ö =====
        function loadSettingsFile(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();

            reader.onload = function(e) {
                try {
                    const content = e.target.result.trim();
                    console.log('File content:', content);

                    let apiKey = '';

                    // –ü–∞—Ä—Å–∏–Ω–≥ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ —Ñ–∞–π–ª–∞
                    if (content.includes('OPENROUTER_API_KEY=')) {
                        const match = content.match(/OPENROUTER_API_KEY=([^\n\r]+)/);
                        apiKey = match ? match[1].trim() : '';
                    } else if (content.includes('API_KEY=')) {
                        const match = content.match(/API_KEY=([^\n\r]+)/);
                        apiKey = match ? match[1].trim() : '';
                    } else {
                        // –ü—Ä–æ—Å—Ç–æ –∫–ª—é—á –Ω–∞ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ
                        apiKey = content.split('\n')[0].trim();
                    }

                    console.log('Extracted API key:', apiKey);

                    if (apiKey && apiKey.length > 20) {
                        currentApiKey = apiKey;
                        API_CONFIG.OPENROUTER_API_KEY = apiKey;

                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
                        localStorage.setItem('gidik_api_config', JSON.stringify({
                            apiKey: apiKey,
                            timestamp: new Date().toISOString()
                        }));

                        // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                        updateApiConfigDisplay();
                        showCurrentConfig();

                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
                        showStatusMessage('API –∫–ª—é—á —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω', 'success');

                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–µ–∫—Ü–∏—é –Ω–∞—Å—Ç—Ä–æ–µ–∫ API
                        const apiConfigSection = document.getElementById('apiConfigSection');
                        if (apiConfigSection) {
                            apiConfigSection.style.display = 'block';
                        }

                        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ç–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
                        setTimeout(() => testApiConnection(), 1000);
                    } else {
                        throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç API –∫–ª—é—á–∞. –ö–ª—é—á –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–ª–∏–Ω–Ω–µ–µ 20 —Å–∏–º–≤–æ–ª–æ–≤.');
                    }
                } catch (error) {
                    console.error('Error loading settings:', error);
                    showStatusMessage(`–û—à–∏–±–∫–∞: ${error.message}`, 'error');
                }
            };

            reader.onerror = function() {
                showStatusMessage('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è —Ñ–∞–π–ª–∞', 'error');
            };

            reader.readAsText(file);
        }

        function showStatusMessage(message, type = 'info') {
            const statusElement = document.getElementById('apiStatus') || document.getElementById('connectionStatus');
            if (statusElement) {
                statusElement.innerHTML = `<div class="status-message status-${type}">${message}</div>`;
                setTimeout(() => {
                    statusElement.innerHTML = '';
                }, 5000);
            }
        }

        // ===== –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò =====
        function updateApiConfigDisplay() {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ localStorage
            const savedConfig = localStorage.getItem('gidik_api_config');
            if (savedConfig) {
                try {
                    const config = JSON.parse(savedConfig);
                    currentApiKey = config.apiKey || '';
                    API_CONFIG.OPENROUTER_API_KEY = currentApiKey;
                } catch (error) {
                    console.error('Error loading config:', error);
                }
            }

            const configInfo = document.getElementById('configInfo');
            const currentConfigInfo = document.getElementById('currentConfigInfo');

            if (currentApiKey) {
                const maskedKey = currentApiKey.substring(0, 8) + '...' + currentApiKey.substring(currentApiKey.length - 4);
                const infoHTML = `
                    <div><strong>üîë API Key:</strong> ${maskedKey}</div>
                    <div><strong>ü§ñ Model:</strong> ${API_CONFIG.MODEL}</div>
                    <div><strong>üîó Status:</strong> <span style="color: #10B981;">‚úì –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ</span></div>
                `;

                if (configInfo) configInfo.innerHTML = infoHTML;
                if (currentConfigInfo) currentConfigInfo.innerHTML = infoHTML;
            } else {
                const errorHTML = '<div style="color: #EF4444;">‚ùå API –∫–ª—é—á –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω</div>';
                if (configInfo) configInfo.innerHTML = errorHTML;
                if (currentConfigInfo) currentConfigInfo.innerHTML = errorHTML;
            }
        }

        function showCurrentConfig() {
            updateApiConfigDisplay();
            const currentConfig = document.getElementById('currentConfig');
            if (currentConfig) {
                if (currentApiKey) {
                    const maskedKey = currentApiKey.substring(0, 8) + '...' + currentApiKey.substring(currentApiKey.length - 4);
                    currentConfig.innerHTML = `
                        <div class="config-info">
                            <div><strong>üîë API Key:</strong> ${maskedKey}</div>
                            <div><strong>ü§ñ Model:</strong> ${API_CONFIG.MODEL}</div>
                            <div><strong>üîó API URL:</strong> ${API_CONFIG.API_URL}</div>
                        </div>
                    `;
                } else {
                    currentConfig.innerHTML = '<div class="config-info" style="color: #EF4444;">‚ùå API –∫–ª—é—á –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –Ω–∞—Å—Ç—Ä–æ–µ–∫.</div>';
                }
            }
        }

        // ===== –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï API =====
        async function testApiConnection() {
            if (!currentApiKey) {
                showStatusMessage('API –∫–ª—é—á –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω', 'error');
                return;
            }

            showStatusMessage('–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...', 'warning');

            try {
                // –ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
                const response = await fetch(API_CONFIG.API_URL, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${currentApiKey}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: API_CONFIG.MODEL,
                        messages: [{ role: "user", content: "–ü—Ä–∏–≤–µ—Ç" }],
                        max_tokens: 10
                    })
                });

                if (response.ok) {
                    showStatusMessage('‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ', 'success');
                } else {
                    const error = await response.text();
                    console.error('API Error:', error);
                    showStatusMessage(`‚ùå –û—à–∏–±–∫–∞ API: ${response.status}`, 'error');
                }
            } catch (error) {
                console.error('Connection error:', error);
                showStatusMessage(`‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}`, 'error');
            }
        }

        // ===== –û–¢–†–ò–°–û–í–ö–ê –ì–û–†–û–î–û–í =====
        function renderCities() {
            const grid = document.getElementById('citiesGrid');
            if (!grid) return;

            grid.innerHTML = '';

            Object.entries(CITIES_DATA).forEach(([cityName, cityData], index) => {
                const cityCard = document.createElement('div');
                cityCard.className = 'city-card';
                cityCard.style.animationDelay = `${index * 0.1}s`;

                // –°–æ–∑–¥–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å –∑–∞–≥–ª—É—à–∫–∞–º–∏
                const imagesHTML = cityData.images.map((imgSrc, i) => `
                    <img src="${imgSrc}"
                         alt="${cityName} - —Ñ–æ—Ç–æ ${i + 1}"
                         class="city-image"
                         onerror="this.onerror=null; this.src='data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"300\" height=\"200\"><rect width=\"300\" height=\"200\" fill=\"%231C4D8D\"/><text x=\"150\" y=\"100\" font-family=\"Arial\" font-size=\"20\" fill=\"white\" text-anchor=\"middle\" dominant-baseline=\"middle\">${cityName}</text></svg>'">
                `).join('');

                cityCard.innerHTML = `
                    <div class="city-header">
                        <div>
                            <div class="city-name">${cityName}</div>
                            <div class="city-rating">
                                <span class="rating-stars">${renderStars(cityData.rating)}</span>
                                <span>${cityData.rating.toFixed(1)}</span>
                            </div>
                        </div>
                        <div class="city-icon">${cityData.icon}</div>
                    </div>

                    <div class="city-description">${cityData.description}</div>

                    <div class="city-images">${imagesHTML}</div>

                    <div class="city-actions">
                        <button class="button" onclick="openCityModal('${cityName}')">
                            <span>üìù</span> –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                        </button>
                        <button class="button button-primary" onclick="generateCityRoute('${cityName}')">
                            <span>üó∫Ô∏è</span> –ú–∞—Ä—à—Ä—É—Ç
                        </button>
                    </div>
                `;

                grid.appendChild(cityCard);
            });
        }

        // ===== –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ì–û–†–û–î–ê =====
        function openCityModal(cityName) {
            const cityData = CITIES_DATA[cityName];
            if (!cityData) return;

            currentCityModal = cityName;

            const modal = document.getElementById('modal');
            const modalContent = document.getElementById('modalContent');

            modalContent.innerHTML = `
                <h2 style="color: var(--text-light); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                    ${cityData.icon} ${cityName}
                </h2>

                <div class="city-rating" style="margin: 1rem 0; font-size: 1.2rem;">
                    <span class="rating-stars">${renderStars(cityData.rating)}</span>
                    <span>${cityData.rating.toFixed(1)} –∏–∑ 5 (${cityData.reviews.length} –æ—Ç–∑—ã–≤–æ–≤)</span>
                </div>

                <div style="margin: 1.5rem 0;">
                    <h3 style="color: var(--primary-accent); margin-bottom: 1rem;">üèõÔ∏è –î–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 0.5rem;">
                        ${cityData.attractions.map(attr => `
                            <div style="background: rgba(189, 232, 245, 0.1); padding: 0.75rem; border-radius: 8px; border: 1px solid var(--primary-accent);">
                                ‚Ä¢ ${attr}
                            </div>
                        `).join('')}
                    </div>
                </div>

                <div style="margin: 1.5rem 0;">
                    <h3 style="color: var(--primary-accent); margin-bottom: 1rem;">‚≠ê –û—Ç–∑—ã–≤—ã –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π:</h3>
                    ${cityData.reviews.map(review => `
                        <div style="background: rgba(28, 77, 141, 0.3); padding: 1rem; border-radius: 10px; margin-bottom: 1rem; border: 1px solid var(--primary-accent);">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <strong style="color: var(--primary-accent);">üë§ ${review.author}</strong>
                                <span class="rating-stars">${renderStars(review.rating)}</span>
                            </div>
                            <div style="color: var(--text-muted);">${review.text}</div>
                        </div>
                    `).join('')}
                </div>

                <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                    <button class="button" onclick="generateCityRoute('${cityName}'); closeModal();" style="flex: 1;">
                        <span>üó∫Ô∏è</span> –°–æ–∑–¥–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç
                    </button>
                    <button class="button button-primary" onclick="showScreen('ai-guide'); closeModal();" style="flex: 1;">
                        <span>ü§ñ</span> –°–ø—Ä–æ—Å–∏—Ç—å AI
                    </button>
                </div>
            `;

            modal.style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
            currentCityModal = '';
        }

        // ===== –ì–ï–ù–ï–†–ê–¶–ò–Ø –ú–ê–†–®–†–£–¢–ê –î–õ–Ø –ì–û–†–û–î–ê =====
        function generateCityRoute(cityName) {
            showScreen('generator');

            const citySelect = document.getElementById('city');
            if (citySelect) {
                citySelect.value = cityName;
            }

            setTimeout(() => {
                const form = document.getElementById('routeForm');
                if (form) {
                    form.dispatchEvent(new Event('submit'));
                }
            }, 100);
        }

        // ===== –ì–ï–ù–ï–†–ê–¢–û–† –ú–ê–†–®–†–£–¢–û–í =====
        document.getElementById('routeForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const city = document.getElementById('city').value;
            const interests = document.getElementById('interests').value;
            const time = parseInt(document.getElementById('time').value);
            const budget = document.getElementById('budget').value;

            const cityData = CITIES_DATA[city];
            if (!cityData) {
                alert('–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥');
                return;
            }

            // –†–∞—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π
            const attractionsCount = Math.min(Math.floor(time / 0.5), 8);
            const selectedAttractions = cityData.attractions.slice(0, attractionsCount);

            const interestsText = {
                history: "üèõÔ∏è –ò—Å—Ç–æ—Ä–∏—è –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞",
                nature: "üå≥ –ü—Ä–∏—Ä–æ–¥–∞ –∏ –ø–∞—Ä–∫–∏",
                culture: "üé≠ –ö—É–ª—å—Ç—É—Ä–∞ –∏ –º—É–∑–µ–∏",
                religion: "‚õ™ –•—Ä–∞–º—ã –∏ –º–æ–Ω–∞—Å—Ç—ã—Ä–∏",
                gastronomy: "üçΩÔ∏è –ï–¥–∞ –∏ –∫–∞—Ñ–µ",
                all: "üåü –í—Å—ë –≤–º–µ—Å—Ç–µ"
            };

            const budgetText = {
                free: "üéØ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ",
                low: "üí∞ –î–æ 500‚ÇΩ",
                medium: "üíµ 500-2000‚ÇΩ",
                high: "üíé –ë–æ–ª–µ–µ 2000‚ÇΩ"
            };

            const routeContent = `
                <div class="route-header">
                    <div class="route-info-grid">
                        <div class="route-info-item">
                            <span class="route-info-label">üìç –ì–æ—Ä–æ–¥</span>
                            <span class="route-info-value">${city}</span>
                        </div>
                        <div class="route-info-item">
                            <span class="route-info-label">üéØ –ò–Ω—Ç–µ—Ä–µ—Å—ã</span>
                            <span class="route-info-value">${interestsText[interests] || interests}</span>
                        </div>
                        <div class="route-info-item">
                            <span class="route-info-label">‚è±Ô∏è –í—Ä–µ–º—è</span>
                            <span class="route-info-value">${time} ${getHoursEnding(time)}</span>
                        </div>
                        <div class="route-info-item">
                            <span class="route-info-label">üí∞ –ë—é–¥–∂–µ—Ç</span>
                            <span class="route-info-value">${budgetText[budget] || budget}</span>
                        </div>
                    </div>
                </div>

                <h3 style="color: var(--primary-accent); margin-bottom: 1rem;">üó∫Ô∏è –ú–∞—Ä—à—Ä—É—Ç –æ—Å–º–æ—Ç—Ä–∞:</h3>

                <div class="route-points">
                    ${selectedAttractions.map((attr, index) => `
                        <div class="route-point">
                            <div class="route-point-number">${index + 1}</div>
                            <div class="route-point-content">
                                <div class="route-point-title">${attr}</div>
                                <div class="route-point-details">
                                    <span>‚è±Ô∏è ~${Math.floor(time/selectedAttractions.length*60)} –º–∏–Ω</span>
                                    <span>${budget === 'free' ? '–ë–µ—Å–ø–ª–∞—Ç–Ω–æ' : '~' + (budget === 'low' ? '100-300‚ÇΩ' : budget === 'medium' ? '300-800‚ÇΩ' : '800-1500‚ÇΩ')}</span>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>

                <div class="route-tips">
                    <h4 class="route-tips-title"><span>üí°</span> –°–æ–≤–µ—Ç—ã –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞</h4>
                    <ul class="route-tips-list">
                        <li class="route-tip-item">–ù–∞—á–Ω–∏—Ç–µ –º–∞—Ä—à—Ä—É—Ç –≤ 9-10 —É—Ç—Ä–∞, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —Ç–æ–ª–ø—ã</li>
                        <li class="route-tip-item">–ù–æ—Å–∏—Ç–µ —É–¥–æ–±–Ω—É—é –æ–±—É–≤—å - –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç –º–Ω–æ–≥–æ —Ö–æ–¥–∏—Ç—å</li>
                        <li class="route-tip-item">–í–æ–∑—å–º–∏—Ç–µ —Å —Å–æ–±–æ–π –≤–æ–¥—É –∏ –ª–µ–≥–∫–∏–π –ø–µ—Ä–µ–∫—É—Å</li>
                        <li class="route-tip-item">–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –º—É–∑–µ–µ–≤ –∏ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π</li>
                        <li class="route-tip-item">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Å—Ç–Ω—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç –º–µ–∂–¥—É —É–¥–∞–ª–µ–Ω–Ω—ã–º–∏ —Ç–æ—á–∫–∞–º–∏</li>
                        <li class="route-tip-item">–°–¥–µ–ª–∞–π—Ç–µ –ø–µ—Ä–µ—Ä—ã–≤ –Ω–∞ –æ–±–µ–¥ –≤ –º–µ—Å—Ç–Ω—ã—Ö –∫–∞—Ñ–µ</li>
                    </ul>
                </div>

                <div class="route-actions">
                    <button class="button" onclick="saveRoute('${city}')" style="flex: 1;">
                        <span>üíæ</span> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç
                    </button>
                    <button class="button button-primary" onclick="askAboutRoute('${city}')" style="flex: 1;">
                        <span>ü§ñ</span> –°–ø—Ä–æ—Å–∏—Ç—å AI
                    </button>
                </div>
            `;

            const routeResult = document.getElementById('routeResult');
            if (routeResult) {
                routeResult.innerHTML = routeContent;
                routeResult.classList.add('show');

                // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
                setTimeout(() => {
                    routeResult.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 300);
            }
        });

        function askAboutRoute(cityName) {
            showScreen('ai-guide');
            setTimeout(() => {
                const chatInput = document.getElementById('chatInput');
                if (chatInput) {
                    chatInput.value = `–†–∞—Å—Å–∫–∞–∂–∏ –ø–æ–¥—Ä–æ–±–Ω–µ–µ –æ –º–∞—Ä—à—Ä—É—Ç–µ –ø–æ ${cityName}`;
                    chatInput.focus();
                    autoResizeTextarea(chatInput);
                }
            }, 100);
        }

        function saveRoute(cityName) {
            const routeContent = document.querySelector('#routeResult .route-header')?.innerText || '';
            const routeDetails = document.querySelector('#routeResult .route-points')?.innerText || '';

            const fullContent = `–ú–ê–†–®–†–£–¢ –ü–û ${cityName.toUpperCase()}\n\n${routeContent}\n\n${routeDetails}`;

            const blob = new Blob([fullContent], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `–º–∞—Ä—à—Ä—É—Ç-${cityName}-${new Date().toISOString().slice(0, 10)}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            showStatusMessage('–ú–∞—Ä—à—Ä—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Ñ–∞–π–ª!', 'success');
        }

        // ===== AI-–ì–ò–î =====
        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            const sendButton = document.getElementById('sendButton');

            if (!message) {
                input.focus();
                return;
            }

            if (!currentApiKey) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ API –∫–ª—é—á –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö');
                showScreen('settings');
                return;
            }

            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            addChatMessage(message, 'user');
            input.value = '';
            sendButton.disabled = true;
            input.disabled = true;
            autoResizeTextarea(input);

            // –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞–±–æ—Ä–∞
            const typingIndicator = addTypingIndicator();

            try {
                // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —Å –∏—Å—Ç–æ—Ä–∏–µ–π
                const messages = [
                    {
                        role: "system",
                        content: `–¢—ã –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –≥–∏–¥-—ç–∫—Å–∫—É—Ä—Å–æ–≤–æ–¥ –ø–æ –ò–≤–∞–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏ –†–æ—Å—Å–∏–∏.
                        –û—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ. –ë—É–¥—å –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–º, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º –∏ –ø–æ–ª–µ–∑–Ω—ã–º.

                        –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≥–æ—Ä–æ–¥–∞—Ö –ò–≤–∞–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏:

                        ${Object.entries(CITIES_DATA).map(([city, data]) =>
                            `–ì–æ—Ä–æ–¥: ${city}
                            –û–ø–∏—Å–∞–Ω–∏–µ: ${data.description}
                            –û—Å–Ω–æ–≤–Ω—ã–µ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: ${data.attractions.slice(0, 5).join(', ')}
                            –†–µ–π—Ç–∏–Ω–≥: ${data.rating} –∏–∑ 5
                            ---`
                        ).join('\n\n')}

                        –ü—Ä–∞–≤–∏–ª–∞ –æ—Ç–≤–µ—Ç–∞:
                        1. –û—Ç–≤–µ—á–∞–π –ø–æ–¥—Ä–æ–±–Ω–æ, –Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ
                        2. –ü—Ä–µ–¥–ª–∞–≥–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
                        3. –£—á–∏—Ç—ã–≤–∞–π –≤—Ä–µ–º—è –≥–æ–¥–∞ –∏ –ø–æ–≥–æ–¥—É –≤ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è—Ö
                        4. –£–ø–æ–º–∏–Ω–∞–π –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (–≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã, —Ü–µ–Ω—ã, –∫–∞–∫ –¥–æ–±—Ä–∞—Ç—å—Å—è)
                        5. –ï—Å–ª–∏ –≤–æ–ø—Ä–æ—Å –Ω–µ —Å–≤—è–∑–∞–Ω —Å –ò–≤–∞–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç—å—é, –≤–µ–∂–ª–∏–≤–æ –ø—Ä–µ–¥–ª–æ–∂–∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ç–µ–º–µ —Ä–µ–≥–∏–æ–Ω–∞
                        6. –ò—Å–ø–æ–ª—å–∑—É–π —ç–º–æ–¥–∑–∏ –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏
                        7. –§–æ—Ä–º–∞—Ç–∏—Ä—É–π –æ—Ç–≤–µ—Ç —Å –ø–æ–º–æ—â—å—é –º–∞—Ä–∫–µ—Ä–æ–≤ –∏ –∞–±–∑–∞—Ü–µ–≤`
                    },
                    ...chatHistory.slice(-5), // –ë–µ—Ä–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
                    { role: "user", content: message }
                ];

                const response = await fetch(API_CONFIG.API_URL, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${currentApiKey}`,
                        'Content-Type': 'application/json',
                        'HTTP-Referer': window.location.origin,
                        'X-Title': '–ì–∏–¥–∏–∫ - AI-–ø—Ä–æ–≤–æ–¥–Ω–∏–∫'
                    },
                    body: JSON.stringify({
                        model: API_CONFIG.MODEL,
                        messages: messages,
                        max_tokens: 1500,
                        temperature: 0.7
                    })
                });

                // –£–¥–∞–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –Ω–∞–±–æ—Ä–∞
                removeTypingIndicator(typingIndicator);

                if (response.ok) {
                    const result = await response.json();
                    const aiResponse = result.choices[0]?.message?.content || '–ò–∑–≤–∏–Ω–∏—Ç–µ, –Ω–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç.';

                    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ AI –≤ —á–∞—Ç
                    addChatMessage(aiResponse, 'ai');

                    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏—é
                    chatHistory.push({ role: "user", content: message });
                    chatHistory.push({ role: "assistant", content: aiResponse });

                    // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏
                    if (chatHistory.length > 20) {
                        chatHistory = chatHistory.slice(-20);
                    }
                } else {
                    const error = await response.text();
                    console.error('API Error:', error);
                    addChatMessage(`–ò–∑–≤–∏–Ω–∏—Ç–µ, –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ AI. –ö–æ–¥ –æ—à–∏–±–∫–∏: ${response.status}`, 'ai');
                }
            } catch (error) {
                removeTypingIndicator(typingIndicator);
                addChatMessage(`–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${error.message}. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.`, 'ai');
            } finally {
                sendButton.disabled = false;
                input.disabled = false;
                input.focus();
            }
        }

        function addChatMessage(text, sender) {
            const messagesContainer = document.getElementById('chatMessages');
            if (!messagesContainer) return;

            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}-message`;

            // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
            const formattedText = text
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\n\n/g, '<br><br>')
                .replace(/\n/g, '<br>');

            messageDiv.innerHTML = formattedText;
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function addTypingIndicator() {
            const messagesContainer = document.getElementById('chatMessages');
            if (!messagesContainer) return null;

            const typingDiv = document.createElement('div');
            typingDiv.className = 'typing-indicator';
            typingDiv.id = 'typingIndicator';
            typingDiv.innerHTML = `
                <span>AI –¥—É–º–∞–µ—Ç</span>
                <span class="typing-dot"></span>
                <span class="typing-dot"></span>
                <span class="typing-dot"></span>
            `;
            messagesContainer.appendChild(typingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            return typingDiv;
        }

        function removeTypingIndicator(typingElement) {
            if (typingElement && typingElement.parentNode) {
                typingElement.parentNode.removeChild(typingElement);
            }
        }

        function handleChatInputKeydown(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        }

        // ===== –£–ü–†–ê–í–õ–ï–ù–ò–ï –î–ê–ù–ù–´–ú–ò =====
        function clearLocalStorage() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ?')) {
                localStorage.removeItem('gidik_api_config');
                currentApiKey = '';
                chatHistory = [];
                updateApiConfigDisplay();
                showStatusMessage('–õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã', 'success');
            }
        }

        function resetApp() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫ –Ω–∞—á–∞–ª—å–Ω—ã–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º?')) {
                localStorage.clear();
                currentApiKey = '';
                chatHistory = [];
                API_CONFIG.OPENROUTER_API_KEY = '';

                // –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã
                document.getElementById('routeForm')?.reset();
                document.getElementById('chatInput').value = '';
                document.getElementById('chatMessages').innerHTML = `
                    <div class="message ai-message">
                        <strong>üëã –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –Ø –≤–∞—à AI-–≥–∏–¥ –ø–æ –ò–≤–∞–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏.</strong>
                        <br><br>
                        –Ø –ø–æ–º–æ–≥—É –≤–∞–º —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ –æ –≥–æ—Ä–æ–¥–∞—Ö, –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è—Ö, –º–∞—Ä—à—Ä—É—Ç–∞—Ö –∏ –∏—Å—Ç–æ—Ä–∏–∏ —Ä–µ–≥–∏–æ–Ω–∞.
                        –ó–∞–¥–∞–π—Ç–µ –º–Ω–µ –ª—é–±–æ–π –≤–æ–ø—Ä–æ—Å –æ –ò–≤–∞–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏!
                    </div>
                `;

                updateApiConfigDisplay();
                showStatusMessage('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–±—Ä–æ—à–µ–Ω–æ –∫ –Ω–∞—á–∞–ª—å–Ω—ã–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º', 'success');
                showScreen('home');
            }
        }

        // ===== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =====
        document.addEventListener('DOMContentLoaded', function() {
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
            const savedConfig = localStorage.getItem('gidik_api_config');
            if (savedConfig) {
                try {
                    const config = JSON.parse(savedConfig);
                    currentApiKey = config.apiKey || '';
                    API_CONFIG.OPENROUTER_API_KEY = currentApiKey;

                    if (currentApiKey) {
                        const apiConfigSection = document.getElementById('apiConfigSection');
                        if (apiConfigSection) {
                            apiConfigSection.style.display = 'block';
                        }
                    }
                } catch (error) {
                    console.error('Error loading config:', error);
                }
            }

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            renderCities();
            updateTimeValue(3);
            updateApiConfigDisplay();

            // –§–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ AI-–≥–∏–¥–∞
            const chatInput = document.getElementById('chatInput');
            if (chatInput) {
                chatInput.addEventListener('focus', function() {
                    if (!currentApiKey) {
                        this.placeholder = "‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ API –∫–ª—é—á –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö...";
                    }
                });

                chatInput.addEventListener('blur', function() {
                    this.placeholder = "–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –æ –ò–≤–∞–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏...";
                });
            }

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            document.getElementById('modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeModal();
                }
            });

            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeModal();
                }
            });

            // –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞ –≤ AI-–≥–∏–¥–µ
            const navButtons = document.querySelectorAll('.nav-button');
            navButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const screenId = this.getAttribute('onclick')?.match(/'([^']+)'/)?.[1];
                    if (screenId === 'ai-guide') {
                        setTimeout(() => {
                            const chatInput = document.getElementById('chatInput');
                            if (chatInput) chatInput.focus();
                        }, 300);
                    }
                });
            });

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–ª–∞–π–¥–µ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏
            const timeSlider = document.getElementById('time');
            if (timeSlider) {
                timeSlider.addEventListener('input', function() {
                    updateTimeValue(this.value);
                });
            }

            console.log('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ "–ì–∏–¥–∏–∫" —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ');
        });
    </script>
</body>
</html>